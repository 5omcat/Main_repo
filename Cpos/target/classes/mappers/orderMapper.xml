<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="OrderMapper">
	<select id="orderList" parameterType="java.util.HashMap" resultType="OrderVO">
	  <![CDATA[
select order_no, member_id, barcode, pname, order_qnt, TO_CHAR(order_date,'YYYY-MM-DD HH24:MI:SS') as order_sdate, wrap_no, expire_term from (select /*+INDEX(tbl_order pk_order)*/
  rownum as rn, order_no, member_id, barcode, pname, order_qnt, order_date, wrap_no, expire_term
  from tbl_order where member_id = 'testMember1' and TO_CHAR(order_date,'YYYYMMDDHH24MISS') >= #{ovo.flag_hdate} and TO_CHAR(order_date,'YYYYMMDDHH24MISS') <= #{ovo.flag_tdate} 
  AND rownum <= #{cri.pageNum} * #{cri.amount})
  where rn > (#{cri.pageNum}-1) * #{cri.amount}
  ]]>
	</select>
	<insert id="order" parameterType="OrderVO">
		insert into tbl_order(order_no, member_id, barcode, pname, order_qnt, order_date, wrap_no, expire_term) values(seq_order_no.nextval, #{member_id}, #{barcode}, #{pname}, #{order_qnt}, sysdate, #{wrap_no}, #{expire_term})
	</insert>
	<select id="totalCount" parameterType="java.util.HashMap" resultType="java.lang.Integer">
	<![CDATA[
	select count(order_no) from tbl_order where member_id = 'testMember1' and TO_CHAR(order_date,'YYYYMMDDHH24MISS') >= #{ovo.flag_hdate} and TO_CHAR(order_date,'YYYYMMDDHH24MISS') <= #{ovo.flag_tdate}
		]]>
	</select>
</mapper>